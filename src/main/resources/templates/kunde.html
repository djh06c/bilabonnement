<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="da">
<head>
  <meta charset="UTF-8" />
  <title>Kunde administration</title>
  <link rel="stylesheet" href="/css/kunde.css">
</head>
<body>

<h1>Kunder</h1>

<!-- Tabel med alle kunder -->
<table>
  <thead>
  <tr>
    <th>Kunde ID</th>
    <th>Navn</th>
    <th>Email</th>
    <th>Adresse</th>
    <th>Telefon</th>
    <th>Fødselsdato</th>
    <th>Handlinger</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="kunde : ${kunder}">
    <td th:text="${kunde.kundeID}"></td>
    <td th:text="${kunde.navn}"></td>
    <td th:text="${kunde.email}"></td>
    <td th:text="${kunde.adresse}"></td>
    <td th:text="${kunde.tlfNr}"></td>
    <td th:text="${kunde.foedselsdato}"></td>
    <td>
      <form th:action="@{'/kunde/slet/' + ${kunde.kundeID}}" method="post" onsubmit="return confirm('Er du sikker på du vil slette?');" style="display:inline;">
        <button type="submit">Slet</button>
      </form>

      <button onclick="udfyldForm([[${kunde.kundeID}]], '[[${kunde.navn}]]', '[[${kunde.email}]]', '[[${kunde.adresse}]]', '[[${kunde.tlfNr}]]', '[[${#temporals.format(kunde.foedselsdato, 'yyyy-MM-dd')}]]')">Rediger</button>
    </td>
  </tr>
  </tbody>
</table>

<!-- Formular til opret / rediger kunde -->
<div class="form-section">
  <h2 id="form-title">Opret ny kunde</h2>
  <form th:action="@{/kunde/opret}" th:object="${kundeModel}" method="post" id="kundeForm">
    <input type="hidden" th:field="*{kundeID}" id="kundeID" />
    <label>Navn: <input type="text" th:field="*{navn}" required /></label><br/>
    <label>Email: <input type="email" th:field="*{email}" required /></label><br/>
    <label>Adresse: <input type="text" th:field="*{adresse}" required /></label><br/>
    <label>Telefon: <input type="text" th:field="*{tlfNr}" required /></label><br/>
    <label>Fødselsdato: <input type="date" th:field="*{foedselsdato}" required /></label><br/>
    <button type="submit" id="submitBtn">Opret kunde</button>
    <button type="button" onclick="nulstilForm()">Nulstil</button>
  </form>
</div>

<script>
  function udfyldForm(kundeID, navn, email, adresse, tlfNr, foedselsdato) {
    document.getElementById('form-title').innerText = "Rediger kunde";
    document.getElementById('kundeID').value = kundeID;
    document.querySelector('input[name="navn"]').value = navn;
    document.querySelector('input[name="email"]').value = email;
    document.querySelector('input[name="adresse"]').value = adresse;
    document.querySelector('input[name="tlfNr"]').value = tlfNr;
    document.querySelector('input[name="foedselsdato"]').value = foedselsdato;
    document.getElementById('kundeForm').action = '/kunde/rediger';
    document.getElementById('submitBtn').innerText = 'Opdater kunde';
  }

  function nulstilForm() {
    document.getElementById('form-title').innerText = "Opret ny kunde";
    document.getElementById('kundeID').value = '';
    document.querySelector('input[name="navn"]').value = '';
    document.querySelector('input[name="email"]').value = '';
    document.querySelector('input[name="adresse"]').value = '';
    document.querySelector('input[name="tlfNr"]').value = '';
    document.querySelector('input[name="foedselsdato"]').value = '';
    document.getElementById('kundeForm').action = '/kunde/opret';
    document.getElementById('submitBtn').innerText = 'Opret kunde';
  }
</script>

</body>
</html>